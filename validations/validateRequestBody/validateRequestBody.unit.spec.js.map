{"version":3,"sources":["../../src/validations/validateRequestBody/validateRequestBody.unit.spec.js"],"names":["validateRequestBody","require","requestBodyProp","isValidDate","fakeRequest","body","storeId","vendorId","priceFamily","dateFrom","dateTo","ignoreThis","ignoreThisToo","fakeRequestArray","invalidValidator","invalidValidatorWithParam","param","describe","test","reqBodyDefs","result","expect","allValid","toBe","errors","length"],"mappings":"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","file":"validateRequestBody.unit.spec.js","sourcesContent":["const validateRequestBody = require('./validateRequestBody');\nconst requestBodyProp = require('./requestBodyProp');\nconst { isValidDate } = require('../../validations');\n\nconst fakeRequest = {\n  body: {\n    storeId: 'STR001',\n    vendorId: 'VND001',\n    priceFamily: 'PRC001',\n    dateFrom: '2018-03-11',\n    dateTo: '2018-03-17',\n    ignoreThis: 0,\n    ignoreThisToo: null,\n  },\n};\n\nconst fakeRequestArray = {\n  body: [\n    {\n      storeId: 'STR001',\n      vendorId: 'VND001',\n      priceFamily: 'PRC001',\n      dateFrom: '2018-03-11',\n      dateTo: '2018-03-17',\n      ignoreThis: 0,\n      ignoreThisToo: null,\n    },\n    {\n      storeId: 'STR002',\n      vendorId: 'VND002',\n      priceFamily: 'PRC002',\n      dateFrom: '2018-03-11',\n      dateTo: '2018-03-17',\n      ignoreThis: 0,\n      ignoreThisToo: null,\n    },\n  ],\n};\n\n\nconst invalidValidator = () => 1 + 1;\nconst invalidValidatorWithParam = param => `${param} notboolean`;\n\ndescribe('utils/validations/validateRequestBody', () => {\n  test('Should pass if req body complied with the definition. All required and All Valid Values', () => {\n    const reqBodyDefs = [\n      requestBodyProp('storeId'),\n      requestBodyProp('vendorId'),\n      requestBodyProp('priceFamily'),\n      requestBodyProp('dateFrom', isValidDate),\n      requestBodyProp('dateTo', isValidDate),\n      requestBodyProp('ignoreThis', null, true),\n      requestBodyProp('ignoreThisToo', null, true),\n    ];\n    const result = validateRequestBody(fakeRequest, reqBodyDefs);\n    expect(result.allValid).toBe(true);\n    expect(result.errors.length).toBe(0);\n  });\n  test('Should fail if req body did not comply with the definition. Invalid validators passed.', () => {\n    const reqBodyDefs = [\n      requestBodyProp('storeid'),\n      requestBodyProp('vendorId', invalidValidatorWithParam),\n      requestBodyProp('priceFamily', invalidValidator),\n      requestBodyProp('dateFrom', isValidDate),\n      requestBodyProp('dateTo', invalidValidatorWithParam),\n      requestBodyProp('ignoreThis', null, false),\n      requestBodyProp('ignoreThisToo', null, true),\n      requestBodyProp('NONEXISTENT'),\n    ];\n    const result = validateRequestBody(fakeRequest, reqBodyDefs);\n    expect(result.allValid).toBe(false);\n    expect(result.errors.length).toBe(5);\n  });\n\n  test('Should fail if req body is not passed', () => {\n    const reqBodyDefs = [\n      requestBodyProp('storeid'),\n      requestBodyProp('vendorId', invalidValidatorWithParam),\n      requestBodyProp('priceFamily', invalidValidator),\n      requestBodyProp('dateFrom', isValidDate),\n      requestBodyProp('dateTo', invalidValidatorWithParam),\n      requestBodyProp('ignoreThis', null, false),\n      requestBodyProp('ignoreThisToo', null, true),\n      requestBodyProp('NONEXISTENT'),\n    ];\n    const result = validateRequestBody({ body: null }, reqBodyDefs);\n    expect(result.allValid).toBe(false);\n    expect(result.errors.length).toBe(1);\n  });\n\n  test('Should fail if req body is empty', () => {\n    const reqBodyDefs = [\n      requestBodyProp('storeid'),\n      requestBodyProp('vendorId', invalidValidatorWithParam),\n      requestBodyProp('priceFamily', invalidValidator),\n      requestBodyProp('dateFrom', isValidDate),\n      requestBodyProp('dateTo', invalidValidatorWithParam),\n      requestBodyProp('ignoreThis', null, false),\n      requestBodyProp('ignoreThisToo', null, true),\n      requestBodyProp('NONEXISTENT'),\n    ];\n    const result = validateRequestBody({ body: {} }, reqBodyDefs);\n    expect(result.allValid).toBe(false);\n  });\n\n  test('Should pass if req body array complied with the definition. All required and All Valid Values', () => {\n    const reqBodyDefs = [\n      requestBodyProp('storeId'),\n      requestBodyProp('vendorId'),\n      requestBodyProp('priceFamily'),\n      requestBodyProp('dateFrom', isValidDate),\n      requestBodyProp('dateTo', isValidDate),\n      requestBodyProp('ignoreThis', null, true),\n      requestBodyProp('ignoreThisToo', null, true),\n    ];\n    const result = validateRequestBody(fakeRequestArray, reqBodyDefs);\n    expect(result.allValid).toBe(true);\n  });\n\n  test('Should fail if req body did not comply with the definition. Invalid validators passed.', () => {\n    const reqBodyDefs = [\n      requestBodyProp('storeid'),\n      requestBodyProp('vendorId', invalidValidatorWithParam),\n      requestBodyProp('priceFamily', invalidValidator),\n      requestBodyProp('dateFrom', isValidDate),\n      requestBodyProp('dateTo', invalidValidatorWithParam),\n      requestBodyProp('ignoreThis', null, false),\n      requestBodyProp('ignoreThisToo', null, true),\n      requestBodyProp('NONEXISTENT'),\n    ];\n    const result = validateRequestBody(fakeRequestArray, reqBodyDefs);\n    expect(result.allValid).toBe(false);\n  });\n});\n"]}